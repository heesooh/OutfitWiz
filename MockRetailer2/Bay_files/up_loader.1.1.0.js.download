!function(){"use strict";let c=null;const l=["debug","info","warn","error"];let d=l.reduce((e,d,a)=>(e[d]=function(){var e="debug"===d?"log":d;if(c&&console&&"function"==typeof console[e]){var t=l.indexOf(c.toString().toLocaleLowerCase());if(!0===c||-1<t&&t<=a){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];const[a,...r]=[...i];console[e](d.toUpperCase()+" - (TTD) "+a,...r)}}},e),{});function e(e){c=e}let o=null,n=null,r=[],a=[];function t(e){var t=e[0],e=e[1];if("setIdentifier"!==t)throw new Error("method not implemented, "+t);f(e)}function i(){s();{let n=o.detectionEventType,e=(r=m(o.triggerElements),m(o.cssSelectors)),i=[];for(var t of e)t&&t.tagName&&"INPUT"===t.tagName&&i.push(t);d.debug("triggers ",r),d.debug("validInputs ",e),a=[],r.forEach(e=>{a.push(e[n])});for(let t=0;t<r.length;t++)r[t][n]=function(){d.debug("Detect event: ",n,"on element, ",r[t]);for(var e of i){e=e.value.trim();if(function(e){var t=/((([^<>()\[\].,;:\s@"]+(\.[^<>()\[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,}))/i;if(o.detectionSubject.includes("email")&&t.test(e))return e=e.match(t)[0].toLowerCase().trim(),d.debug("We detected email: "+e),p(e,"email"),1;return}(e)){d.debug("We detected: ",e),u();break}}a[t]&&a[t](...arguments)}}}function u(){d.debug("Detection stopped."),o.detectDynamicNodes&&(d.debug("Checking for dynamically added elements is turned off."),n)&&(n.disconnect(),n=null),s()}function s(){for(let e=0;e<r.length;e++)r[e][o.detectionEventType]=a[e];r=[],a=[]}function f(e){if(!e||!e.type||!e.identifier)throw new Error("wrong identifier format");if("email"!==e.type)throw new Error("Identifier type is not supported, "+detailsdetails.type);p(e.identifier,e.type),u()}function p(e,t){var n;e&&t&&(n=new CustomEvent("detected-identifier",{detail:{identifier:e,type:t}}),d.info("Dispatched event with identifier: ",e," and type: ",t),window.dispatchEvent(n))}function m(t){let n=[];for(var e of t)0<e.length&&document.querySelectorAll(e).forEach(e=>{n.includes(e)||n.push(e)});var i=window.location.hostname,o=document.getElementsByTagName("iframe");for(let e=0;e<o.length;e++)if(function(e,t){if(t.src)try{var n=e===new URL(t.src).hostname;return n&&d.debug("Iframe "+t.src+" can be accessed"),n}catch(e){d.debug("error: ",e)}}(i,o[e])&&o[e].contentDocument)for(var r of t)0<r.length&&o[e].contentDocument.querySelectorAll(r).forEach(e=>{n.includes(e)||n.push(e)});return n}window.ttdPixel={},window.ttdPixel.startDetection=function(e){o=e,d.info("Detection started! Library is configured to detect: ",o.detectionSubject),d.info("Detection event type is ",o.detectionEventType),d.debug("Full config: ",o),"onsubmit"===o.detectionEventType||"onclick"===o.detectionEventType?(i(),o.detectDynamicNodes&&o.detectDynamicNodes&&new MutationObserver(function(e,t){d.debug("Detected dynamically added nodes."),n=t,i()}).observe(document.querySelector("body"),{childList:!0,subtree:!0})):d.debug("Detection type not supported! We will not start auto detection."),window.ttdPixelEventsLayer=window.ttdPixelEventsLayer||[],window.ttdPixelEventsLayer.forEach(t),window.ttdPixelEventsLayer.push=function(e){return Array.prototype.push.call(window.ttdPixelEventsLayer,e),t(e),this.length}},window.ttdPixel.setIdentifier=f,window.ttdPixel.enableDebug=()=>e("debug"),window.ttdPixel.disableLog=()=>e(null)}();var ttd_dom_ready=function(){var t,n,i={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},u={isReady:!1,readyWait:1,holdReady:function(e){e?u.readyWait++:u.ready(!0)},ready:function(e){if(!0===e&&!--u.readyWait||!0!==e&&!u.isReady){if(!document.body)return setTimeout(u.ready,1);(u.isReady=!0)!==e&&0<--u.readyWait||t.resolveWith(document,[u])}},bindReady:function(){if(!t){if(t=u._Deferred(),"complete"===document.readyState)return setTimeout(u.ready,1);if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",u.ready,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",n),window.attachEvent("onload",u.ready);var e=!1;try{e=null==window.frameElement}catch(e){}document.documentElement.doScroll&&e&&o()}}},_Deferred:function(){var d,n,a,c=[],l={done:function(){if(!a){var e,t,n,i,o,r=arguments;for(d&&(o=d,d=0),e=0,t=r.length;e<t;e++)"array"===(i=u.type(n=r[e]))?l.done.apply(l,n):"function"===i&&c.push(n);o&&l.resolveWith(o[0],o[1])}return this},resolveWith:function(e,t){if(!a&&!d&&!n){t=t||[],n=1;try{for(;c[0];)c.shift().apply(e,t)}finally{d=[e,t],n=0}}return this},resolve:function(){return l.resolveWith(this,arguments),this},isResolved:function(){return!(!n&&!d)},cancel:function(){return a=1,c=[],this}};return l},type:function(e){return null==e?String(e):i[Object.prototype.toString.call(e)]||"object"}};function o(){if(!u.isReady){try{document.documentElement.doScroll("left")}catch(e){return void setTimeout(o,1)}u.ready()}}return document.addEventListener?n=function(){document.removeEventListener("DOMContentLoaded",n,!1),u.ready()}:document.attachEvent&&(n=function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",n),u.ready())}),function(e){u.bindReady(),u.type(e),t.done(e)}}();function TTDUniversalPixelApi(O){this.getVersion=function(){return"1.1.0"},this.init=function(t,i,o,r,d){if("string"==typeof arguments[3]&&(arguments[3]=null,4<arguments.length))for(var a=4;a<arguments.length;a++)arguments[a-1]=arguments[a];if(t&&""!=t&&i&&!(i.length<=0)){var c=document.getElementsByTagName("body")[0];if(c){var l="",u={MonetaryValue:"v",MonetaryValueFormat:"vf"},s=[];if("undefined"!=typeof _pixelParams)for(var a in _pixelParams){var f=_pixelParams[a],p=u[a];p&&f&&!/%%.*%%/i.test(f)&&s.push(p+"="+encodeURIComponent(f))}var m="adv="+t,g="upid="+i.join(","),y=O||function(){var e=window,t="",n=!1;try{top.location.href&&(t=top.location.href)}catch(e){n=!0}if(n)for(;;)try{if(t=e.document.referrer,window.parent==e)break;e=window.parent}catch(e){break}-1<t.indexOf("cloudfront.net")&&(t=function(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");t=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}(t,"url")||t);return t}(),l=o+"?"+m+"&ref="+encodeURIComponent(y)+"&"+g+"&upv="+this.getVersion();if(r)for(var v in r)l=l+"&"+v+"="+r[v];0<s.length&&(l=l+"&"+s.join("&"));let n;const W=new Promise((e,t)=>{n=e});var w=null,h=!1,b=null;"function"==typeof __tcfapi?(D=setTimeout(k,1e3),__tcfapi("addEventListener",2,N)):"function"==typeof __cmp?(w=setTimeout(P,1e3),__cmp("ping",null,j)):"function"==typeof __gpp?void 0!==(m=L()).gppString?U(m.gppString,m.gppSid):(_=setTimeout(x,1e3),__gpp("addEventListener",T)):I();let e=void 0!==d?!0:!1;if(e){let i=new Promise(t=>{window.addEventListener("detected-identifier",function(e){t(e.detail.identifier)}),window.ttdPixel.startDetection(d)});window.__uid2=window.__uid2||{},window.__uid2.callbacks=window.__uid2.callbacks||[],window.__uid2.callbacks.push(async(e,t)=>{switch(e){case"SdkLoaded":__uid2.init({baseUrl:d.baseUrl});break;case"InitCompleted":var n;t.identity?await C(t.identity.advertising_token):(n=await i,await __uid2.setIdentityFromEmail(n,d));break;case"IdentityUpdated":await C(t.identity.advertising_token)}})}var _=null,E=!1,D=null,S=!1;function L(){var e,t=__gpp("getGPPData"),t={gppString:t?.gppString,gppSid:t?.applicableSections?.join(",")};return void 0===t.gppString&&(e=__gpp("ping"),t.gppString=e?.gppString,t.gppSid=e?.applicableSections?.join(",")),t}function T(e,t){var n;E?__gpp("removeEventListener",function(){},e.listenerId):"signalStatus"===e.eventName&&"ready"===e.data&&(n=L(),clearTimeout(_),b=new Date,U(n.gppString,n.gppSid),__gpp("removeEventListener",function(){},e.listenerId))}function x(){E=!0,I()}function P(){h=!0,I()}function j(e){h||(e.cmpLoaded||e.gdprAppliesGlobally?(clearTimeout(w),b=new Date,__cmp("getConsentData",null,I)):setTimeout(function(){__cmp("ping",null,j)},200))}function I(e){null!=b&&(l=l+"&ret="+(new Date-b)),h&&(l+="&pto=1"),null!=e&&(l=l+"&gdpr="+(e.gdprApplies?"1":"0")+"&gdpr_consent="+e.consentData),A()}function A(){var e="universal_pixel_"+i.join("_");n(l),R(l,e,"TTD Universal Pixel")}async function C(e){R(await W+"&uiddt="+e,"universal_pixel_"+i.join("_")+"_uid","TTD Universal Pixel with UID")}function R(e,t,n){let i=document.getElementById(t);for(;i&&i.parentElement.removeChild(i),i=document.getElementById(t););let o=document.createElement("iframe");function r(){c.appendChild(o)}o.setAttribute("id",t),o.setAttribute("height",0),o.setAttribute("width",0),o.setAttribute("style","display:none;"),o.setAttribute("src",e),o.setAttribute("title",n),"complete"===document.readyState?setTimeout(r,0):window.addEventListener?window.addEventListener("load",r):window.attachEvent?window.attachEvent("onload",r):r()}function k(){S=!0,I()}function N(e,t){S?__tcfapi("removeEventListener",2,function(e){},e.listenerId):t&&(clearTimeout(D),t=e,null!=b&&(l=l+"&ret="+(new Date-b)),S&&(l+="&pto=1"),null!=t&&(l=l+"&gdpr="+function(e){return e?"1":"0"}(t.gdprApplies)+"&gdpr_consent="+t.tcString),A(),b=new Date,__tcfapi("removeEventListener",2,function(e){},e.listenerId))}function U(e,t){null!=b&&(l=l+"&ret="+(new Date-b)),null!=e&&(l=l+"&gpp_consent="+e),null!=t&&(l=l+"&gpp_sid="+t),A()}}}}}
