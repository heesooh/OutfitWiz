// For license information, see `https://assets.adobedtm.com/aaa144e582c6/0d3a9380a0c9/ab80b19a3b9b/RCd08a7b20b2784a16a3224429a91ebabc-source.js`.
_satellite.__registerScript('https://assets.adobedtm.com/aaa144e582c6/0d3a9380a0c9/ab80b19a3b9b/RCd08a7b20b2784a16a3224429a91ebabc-source.min.js', "try{_satellite.logger.log(\"GA Event Fired\",pageData.eventData);var ga_id=_satellite.getVar(\"ga_id\"),ua_params={},ga4_params={};ua_params.page_location=_satellite.getVar(\"Email_Escape_Page_URL\")?_satellite.getVar(\"Email_Escape_Page_URL\"):void 0,ua_params.user_id=_satellite.getVar(\"User_ID\")?_satellite.getVar(\"User_ID\"):void 0,ga4_params.user_id=_satellite.getVar(\"User_ID\")?_satellite.getVar(\"User_ID\"):void 0,_satellite.getVar(\"Email_Escape_Referrer\")&&(ua_params.referrer=_satellite.getVar(\"Email_Escape_Referrer\")),ua_params.dimension1=_satellite.getVar(\"Visitor_SHA256_Email\")?_satellite.getVar(\"Visitor_SHA256_Email\"):void 0,ua_params.dimension2=_satellite.getVar(\"GA_Client_ID\")?_satellite.getVar(\"GA_Client_ID\"):void 0,ua_params.dimension3=_satellite.getVar(\"Visitor_Loyalty_ID\")?_satellite.getVar(\"Visitor_Loyalty_ID\"):void 0,ua_params.dimension5=ua_params.dimension3?ua_params.dimension3:void 0,ua_params.dimension6=pageData&&pageData.visitor&&pageData.visitor.express_checkout?pageData.visitor.express_checkout:void 0,ua_params.dimension7=_satellite.getVar(\"Email_Escape_Page_Path\")?_satellite.getVar(\"Email_Escape_Page_Path\"):void 0,ua_params.dimension8=_satellite.getVar(\"Email_Escape_Page_Query\")?_satellite.getVar(\"Email_Escape_Page_Query\"):void 0,ua_params.dimension9=_satellite.getVar(\"Order_Shipping_Method\")?_satellite.getVar(\"Order_Shipping_Method\"):void 0,ua_params.dimension10=_satellite.getVar(\"Order_Payment_ Methods\")?_satellite.getVar(\"Order_Payment_ Methods\"):void 0,ua_params.dimension11=_satellite.getVar(\"Order_Loyalty_Total\")?_satellite.getVar(\"Order_Loyalty_Total\"):void 0,ua_params.dimension14=pageData&&pageData.page&&pageData.page.adobePageName?pageData.page.adobePageName:void 0,ua_params.dimension18=_satellite.getVar(\"QP_site_refer\")?_satellite.getVar(\"QP_site_refer\"):void 0,ua_params.dimension24=pageData&&pageData.site&&pageData.site.locale?pageData.site.locale:void 0,ua_params.dimension26=_satellite.getVar(\"itm_campaign\")?_satellite.getVar(\"itm_campaign\"):void 0,ua_params.dimension28=_satellite.getVar(\"itm_source\")?_satellite.getVar(\"itm_source\"):void 0,ua_params.dimension29=_satellite.getVar(\"itm_medium\")?_satellite.getVar(\"itm_medium\"):void 0,ua_params.dimension53=_satellite.getVar(\"Product_Category_L1\")?_satellite.getVar(\"Product_Category_L1\"):void 0,ua_params.dimension54=_satellite.getVar(\"Product_Category_L2\")?_satellite.getVar(\"Product_Category_L2\"):void 0,ua_params.dimension55=_satellite.getVar(\"Product_Category_L3\")?_satellite.getVar(\"Product_Category_L3\"):void 0,ua_params.dimension56=_satellite.getVar(\"Product_Category_L4\")?_satellite.getVar(\"Product_Category_L4\"):void 0,ua_params.dimension57=_satellite.getVar(\"Product_Category_L5\")?_satellite.getVar(\"Product_Category_L5\"):void 0,ua_params.dimension58=_satellite.getVar(\"utm_medium\")?_satellite.getVar(\"utm_medium\"):void 0,ua_params.dimension59=_satellite.getVar(\"utm_source\")?_satellite.getVar(\"utm_source\"):void 0,ua_params.dimension60=_satellite.getVar(\"utm_campaign\")?_satellite.getVar(\"utm_campaign\"):void 0,ua_params.dimension61=_satellite.getVar(\"utm_content\")?_satellite.getVar(\"utm_content\"):void 0,ua_params.dimension62=_satellite.getVar(\"utm_term\")?_satellite.getVar(\"utm_term\"):void 0,ua_params.send_to=ga_id.ua,ga4_params.send_to=ga_id.ga4,ua_action=void 0,ga4_action=void 0;var event_name=pageData.CPEvents.name,sendHit=function(){if(null!=ua_action)if(/add_to_cart|remove_from_cart|view_item|begin_checkout|checkout_progress/gi.test(ua_action))ua_params.items=_satellite.getVar(\"Ecommerce_Object\").items,gtag(\"event\",ua_action,ua_params);else if(/purchase/gi.test(ua_action)){for(var e=window.pageData.order,a=[],t=0;t<products_final.length;t++)a.push({name:products_final[t].name,brand:products_final[t].brand,price:products_final[t].price,id:products_final[t].code,quantity:products_final[t].quantity?products_final[t].quantity:\"\",metric2:products_final[t].discount_amount});var r=r,i={transaction_id:e.id,affiliation:\"\",value:parseFloat(e.subtotal)-parseFloat(e.discount_total),tax:e.tax_total?e.tax_total:\"\",shipping:e.shipping_total?e.shipping_total:\"\",coupon:r,dimension23:e.billing_zip,dimension27:e.promo_code,dimension19:_satellite.getVar(\"Delivery_Category\"),products:a};ua_params.items=i.products,console.log(ua_params.items),gtag(\"event\",ua_action,ua_params)}else gtag(\"event\",ua_action,ua_params),_satellite.logger.log(\"Google Analytics Event[UA]\",ua_params);null!=ga4_action&&(/add_to_cart|remove_from_cart|view_item|begin_checkout|purchase/gi.test(ga4_action)?(ga4_params.items=_satellite.getVar(\"Ecommerce_Object_A+W\"),gtag(\"event\",ga4_action,ga4_params)):gtag(\"event\",ga4_action,ga4_params),_satellite.logger.log(\"Google Analytics Event[GA4]\",ga4_params))},setParameters_Products=function(e,a,t,r,i,s,o,_,c,n){if(ga4_action=i,ga4_params.product_interaction_type=s,ga4_params.product_interaction_value=o,ga4_params.product_id=_,ga4_params.product_name=c,n&&n.length>0)for(var l=0;l<n.length;l++){var d=n[l].split(\"=\")[0],p=n[l].split(\"=\")[1];ga4_params[d]=p}if(ua_action=e,ua_params.event_category=a,ua_params.event_label=t,r&&r.length>0)for(var m=0;m<r.length;m++){var g=r[m].split(\"=\")[0],u=r[m].split(\"=\")[1];ua_params[g]=u}sendHit()},setParameters_NonProducts=function(e,a,t,r,i,s){if(ga4_action=a,i&&i.length>0)for(var o=0;o<i.length;o++){var _=i[o].split(\"=\")[0],c=i[o].split(\"=\")[1];ga4_params[_]=c}if(ua_action=e,ua_params.event_category=t,ua_params.event_label=r,s&&s.length>0)for(var n=0;n<s.length;n++){var l=s[n].split(\"=\")[0],d=s[n].split(\"=\")[1];ua_params[l]=d}sendHit()};switch(event_name){case\"sizeChangeClick\":setParameters_Products(\"size change click\",\"product interaction\",_satellite.getVar(\"Product_Interaction_Name\"),[\"dimension13=\"+pageData.products[0].code],\"product_interaction\",\"size change click\",_satellite.getVar(\"Product_Interaction_Name\"),pageData.products[0].code,pageData.products[0].name);break;case\"productAccordionClick\":setParameters_Products(\"accordion click\",\"product interaction\",_satellite.getVar(\"Product_Interaction_Name\"),[\"dimension13=\"+pageData.products[0].code],\"product_interaction\",\"accordion click\",_satellite.getVar(\"Product_Interaction_Name\"),pageData.products[0].code,pageData.products[0].name);break;case\"sizeGuideClick\":setParameters_Products(\"size guide click\",\"product interaction\",_satellite.getVar(\"Product_Interaction_Name\"),[\"dimension13=\"+pageData.products[0].code],\"product_interaction\",\"size guide click\",_satellite.getVar(\"Product_Interaction_Name\"),pageData.products[0].code,pageData.products[0].name);break;case\"fullsizeImageClick\":setParameters_Products(\"full size image click\",\"product interaction\",_satellite.getVar(\"Product_Interaction_Name\"),[\"dimension13=\"+pageData.products[0].code],\"product_interaction\",\"full size image click\",_satellite.getVar(\"Product_Interaction_Name\"),pageData.products[0].code,pageData.products[0].name);break;case\"colorChangeClick\":setParameters_Products(\"color change click\",\"product interaction\",_satellite.getVar(\"Product_Interaction_Name\"),[\"dimension13=\"+pageData.products[0].code],\"product_interaction\",\"color change click\",_satellite.getVar(\"Product_Interaction_Name\"),pageData.products[0].code,pageData.products[0].name);break;case\"favoritesAdd\":setParameters_Products(\"add to favorites\",\"product interaction\",_satellite.getVar(\"Product_Interaction_Name\"),[\"dimension13=\"+pageData.products[0].code],\"product_interaction\",\"add to favorites\",_satellite.getVar(\"Product_Interaction_Name\"),pageData.products[0].code,pageData.products[0].name);break;case\"altImageView\":setParameters_Products(\"view alternate images\",\"product interaction\",_satellite.getVar(\"Product_Interaction_Name\"),[\"dimension13=\"+pageData.products[0].code],\"product_interaction\",\"view alternate images\",_satellite.getVar(\"Product_Interaction_Name\"),pageData.products[0].code,pageData.products[0].name)}switch(event_name){case\"chatOpen\":setParameters_NonProducts(\"open chat overlay\",\"chat_open\",\"chat\",_satellite.getVar(\"Email_Escape_Page_Path\"));break;case\"chatClose\":setParameters_NonProducts(\"close chat overlay\",\"chat_close\",\"chat\",_satellite.getVar(\"Email_Escape_Page_Path\"));break;case\"chatCustomerService\":setParameters_NonProducts(\"connect with customer service\",\"chat_connect\",\"chat\",_satellite.getVar(\"Email_Escape_Page_Path\"),[\"connect_with=customer service\"]);break;case\"chatStylist\":setParameters_NonProducts(\"connect with stylist\",\"chat_connect\",\"chat\",_satellite.getVar(\"Email_Escape_Page_Path\"),[\"connect_with=stylist\"]);break;case\"storeLocator\":setParameters_NonProducts(\"search\",void 0,\"store locator\",_satellite.getVar(\"Store_Search_Text\"),void 0,[\"metric2=1\"]);break;case\"socialIconClick\":setParameters_NonProducts(\"social exit\",\"social_exit\",\"external links\",pageData.CPEvents.socialPlatformExitLink,[\"social_url=\"+pageData.CPEvents.socialPlatformExitLink]);break;case\"AppStoreClick\":setParameters_NonProducts(\"app store link\",\"exit_link\",\"external links\",\"https://itunes.apple.com/ca/app/hudsons-bay-shop-online/id1455098954\",[\"exit_url=https://apps.apple.com/ca/app/hudsons-bay-shop-online/id1455098954\"]);break;case\"downloadLinkClick\":setParameters_NonProducts(pageData.CPEvents.clickURL,void 0,\"downloads\",pageData.CPEvents.clickText);break;case\"siteSearch\":ua_params.page_location=pageData.CPEvents.location,ua_params.dimension22=_satellite.getVar(\"ga_search_term\")?_satellite.getVar(\"ga_search_term\"):void 0,setParameters_NonProducts(_satellite.getVar(\"Search_Type_GA\"),\"site_search\",\"site search\",_satellite.getVar(\"Search_Term\"),[\"search_term=\"+_satellite.getVar(\"Search_Term\"),\"search_type=\"+_satellite.getVar(\"Search_Type_GA\")]);break;case\"outboundLinkClick\":setParameters_NonProducts(\"exit link\",void 0,\"external links\",pageData.CPEvents.clickURL);break;case\"emailSignup1\":setParameters_NonProducts(\"email signup\",\"sign_up\",\"account\",_satellite.getVar(\"Email_Signup_Location\"),[\"method=email\",\"signup_location=\"+_satellite.getVar(\"Email_Signup_Location\")]);break;case\"AccountRegisteration\":setParameters_NonProducts(\"register\",\"sign_up\",\"account\",void 0,[\"method=account\"]);break;case\"bopusSearch\":_satellite.getVar(\"Check for Store W/O inventory\")&&0==_satellite.getVar(\"Check for Store W/O inventory\")?setParameters_NonProducts(\"store results without inventory\",\"check_stores_results_no_inventory\",\"check stores\",\"0\",[\"store_search_criteria=0\"]):_satellite.getVar(\"Check for Store W/O inventory\")&&0!=_satellite.getVar(\"Check for Store W/O inventory\")&&setParameters_NonProducts(\"store results with inventory\",\"check_stores_results_with_inventory\",\"check stores\",_satellite.getVar(\"Check for Store W/O inventory\"),[\"store_search_criteria=\"+_satellite.getVar(\"Check for Store W/O inventory\")]);break;case\"ScrollTracking\":setParameters_NonProducts(pageData.CPEvents.scrollDepth+\"%\",void 0,\"scroll depth\",_satellite.getVar(\"Email_Escape_Page_Path\"),void 0,[\"non_interaction=true\"]);break;case\"siteSearch_and_viewItem\":ua_params.page_location=pageData.CPEvents.location,setParameters_NonProducts(_satellite.getVar(\"Search_Type_GA\"),\"site_search\",\"site search\",_satellite.getVar(\"Search_Term\"),[\"search_term=\"+_satellite.getVar(\"Search_Term\"),\"search_type=\"+_satellite.getVar(\"Search_Type_GA\")]),setParameters_Products(\"view_item\",\"ecommerce\",_satellite.getVar(\"Product_ID\"),void 0,\"view_item\",void 0,void 0,void 0,void 0,[\"pdp_view_type=standard pdp\"])}switch(event_name){case\"addToCart\":setParameters_Products(\"add_to_cart\",\"ecommerce\",void 0,void 0,\"add_to_cart\");break;case\"removeFromCart\":setParameters_Products(\"remove_from_cart\",\"ecommerce\",void 0,void 0,\"remove_from_cart\");break;case\"viewItem\":ua_params.dimension20=window.pageData.products[0].name,ua_params.dimension21=window.pageData.products[0].brand,setParameters_Products(\"view_item\",\"ecommerce\",_satellite.getVar(\"Product_ID\"),void 0,\"view_item\",void 0,void 0,void 0,void 0,[\"pdp_view_type=standard pdp\"]);break;case\"quickView\":ua_params.dimension20=pageData.eventData.products[0].name,ua_params.dimension21=pageData.eventData.products[0].brand,ua_params.dimension13=pageData.eventData.products&&pageData.eventData.products[0]?pageData.eventData.products[0].code:pageData.eventData.products.items&&pageData.eventData.products.items[0]?pageData.eventData.products.items[0].id:void 0,setParameters_Products(\"view_item\",\"ecommerce\",ua_params.dimension13,void 0,\"view_item\",void 0,void 0,void 0,void 0,[\"pdp_view_type=quickview\"]);break;case\"checkoutStep1\":setParameters_Products(\"begin_checkout\",\"ecommerce\",\"step 1\",[\"non_interaction=true\"],\"begin_checkout\");break;case\"checkoutStep2\":setParameters_Products(\"checkout_progress\",\"ecommerce\",\"step 2\",[\"non_interaction=true\",\"checkout_step=2\"]);break;case\"promotionImpression\":setParameters_Products(\"view_promotion\",\"ecommerce\",\"\",[\"non_interaction=true\"]);break;case\"purchase\":ga4_params.coupon=_satellite.getVar(\"Order_Coupon\"),ga4_params.transaction_id=_satellite.getVar(\"Order_ID\"),ga4_params.shipping=_satellite.getVar(\"Order_Shipping_Total\"),ga4_params.tax=_satellite.getVar(\"Order_Tax_Total\"),ga4_params.value=_satellite.getVar(\"Order_Subtotal_Minus_Discounts\"),ga4_params.discount=_satellite.getVar(\"Order_Discount_Total\"),ga4_params.currency=pageData.order&&pageData.order.currency?pageData.order.currency:\"CAD\",ua_params.coupon=_satellite.getVar(\"Order_Coupon\"),ua_params.transaction_id=_satellite.getVar(\"Order_ID\"),ua_params.shipping=_satellite.getVar(\"Order_Shipping_Total\"),ua_params.tax=_satellite.getVar(\"Order_Tax_Total\"),ua_params.value=_satellite.getVar(\"Order_Subtotal_Minus_Discounts\"),ua_params.discount=_satellite.getVar(\"Order_Discount_Total\"),ua_params.currency=pageData.order&&pageData.order.currency?pageData.order.currency:\"CAD\",ua_params.dimension23=pageData.order.billing_zip,ua_params.dimension27=pageData.order.promo_code,ua_params.dimension19=_satellite.getVar(\"Delivery_Category\"),setParameters_Products(\"purchase\",\"ecommerce\",pageData.order.id,[\"non_interaction=true\",\"metric1=\"+pageData.order.discount_total],\"purchase\")}}catch(e){_satellite.logger.log(\"GA4-UA pageEvent Error\",e)}");